<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.myweb.stock.dao.StockMapper">
    <resultMap id="stockMap" type="com.myweb.stock.model.StockInfo">
        <id column="stock_id" property="stockId" jdbcType="INTEGER"/>
        <result column="brand_id" property="brandId" jdbcType="INTEGER"/>
        <result column="color_id" property="colorId" jdbcType="INTEGER"/>
        <result column="model_id" property="modelId" jdbcType="INTEGER"/>
        <result column="memory_id" property="memoryId" jdbcType="INTEGER"/>
        <result column="number" property="number" jdbcType="INTEGER"/>
    </resultMap>


    <select id="findStock" parameterType="com.myweb.stock.model.StockArgs" resultMap="stockMap">
        SELECT
          s.*
        FROM
          stock_info AS s
        <where>
            1=1
            <if test="brandId != null">and s.brand_id = #{brandId}</if>
            <if test="colorId != null">and s.color_id = #{colorId}</if>
            <if test="memoryId != null">and s.memory_id = #{memoryId}</if>
            <if test="modelId != null">and s.model_id = #{modelId}</if>
        </where>
    </select>

    <insert id="save" parameterType="com.myweb.stock.model.StockInfo">
        INSERT INTO
          stock_info
        (
          brand_id,
          color_id,
          model_id,
          memory_id
        )
        VALUES
        (
          #{brandId},
          #{colorId},
          #{modelId},
          #{memoryId}
        )
    </insert>

    <update id="addNumber">
        UPDATE
          stock_info
        SET
          `number` = `number` + 1
        WHERE
          stock_id = #{stockId}
    </update>

    <update id="descNumber">
         UPDATE
          stock_info
        SET
          `number` = `number` - 1
        WHERE
          stock_id = #{stockId}
    </update>

</mapper>